import pymysql

# MySQL 서버 연결 설정
conn = pymysql.connect(
    host="your_mysql_host",
    user="your_mysql_user",
    password="your_mysql_password",
    database="your_database_name"
)

# 커서 생성
cursor = conn.cursor()

# 연구자와 보호 프로그램에 대한 조인 쿼리
join_query = """
SELECT Researcher.FirstName, Researcher.LastName, Researcher.Affiliation,
       ConservationProgram.Name as ProgramName, StartDate, EndDate, Description
FROM Researcher
JOIN ObservationRecord ON Researcher.ResearcherID = ObservationRecord.ResearcherID
JOIN ConservationProgram ON ObservationRecord.ProgramID = ConservationProgram.ProgramID;
"""

# 조인 쿼리 실행
cursor.execute(join_query)

# 결과 가져오기
result = cursor.fetchall()

# 결과 출력
for row in result:
    print(row)

# 연결 종료
cursor.close()
conn.close()
